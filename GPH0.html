<!DOCTYPE html>

<html>

<head>
<style>
	body {
		overflow: hidden;
	}
</style>
</head>

<body> 
	<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r74/three.min.js"></script>
	<script src="controls/OrbitControls.js"></script>
	<script src="https://code.jquery.com/jquery-2.1.4.min.js">
	</script>
<script>
	var camera, scene, renderer;
	var train = new THREE.Object3D();
	var track = new THREE.Object3D();
	var wood = new THREE.Object3D();
	var clock = new THREE.Clock();
	var angle = 0;

	init();
	animate();

	function init() {
		scene = new THREE.Scene();
		camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 1, 1000);
		camera.position.set(0, 200, 200);
		scene.add(camera);
		
		///////////////////////////////////////
		
		//模型
		modelmake();
		//軌道
		trackmake();

		
		////////////////////////////////////////

		var gridXZ = new THREE.GridHelper(100, 10);
		gridXZ.setColors(new THREE.Color(0xff0000), new THREE.Color(0xffffff));
		scene.add(gridXZ);
		
		var light = new THREE.PointLight(0xffffff, 1);
	  light.position.set(150, 150, 150);
	  scene.add(light);
	  var amblight = new THREE.AmbientLight(0x404040); // soft white light
	  scene.add(amblight);

		renderer = new THREE.WebGLRenderer();
		renderer.setSize(window.innerWidth, window.innerHeight);
		renderer.setClearColor(0x888888);

		controls = new THREE.OrbitControls(camera, renderer.domElement);

		document.body.appendChild(renderer.domElement);
		window.addEventListener('resize', onWindowResize, false);

	}

	function modelmake(){

			THREE.ImageUtils.crossOrigin = '';
			var a = new THREE.Mesh(new THREE.CylinderGeometry( 7, 7, 25, 32 ), new THREE.MeshLambertMaterial( {map: THREE.ImageUtils.loadTexture( 'http://i.imgur.com/LVFA9YT.png' ), overdraw: true} ));
		a.rotation.x = Math.PI/2;
		a.position.y = 7;
		a.position.z = 5;
		train.add(a);
		var b = new THREE.Mesh(new THREE.CylinderGeometry( 5, 5, 1, 32 ), new THREE.MeshLambertMaterial( {map: THREE.ImageUtils.loadTexture( 'http://i.imgur.com/LVFA9YT.png' ), overdraw: true} ));
		b.rotation.x = Math.PI/2;
		b.position.y = 7;
		b.position.z = 18;
		train.add(b);
		var c = new THREE.Mesh(new THREE.CylinderGeometry( 1, 1, 1, 32 ), new THREE.MeshLambertMaterial( {map: THREE.ImageUtils.loadTexture( 'http://i.imgur.com/LVFA9YT.png' ), overdraw: true} ));
		c.rotation.x = Math.PI/2;
		c.position.y = 7;
		c.position.z = 19;
		train.add(c);
		
		var button = new THREE.Mesh(new THREE.BoxGeometry( 10, 5, 40), new THREE.MeshLambertMaterial( {map: THREE.ImageUtils.loadTexture( 'http://i.imgur.com/LVFA9YT.png' ), overdraw: true} ));
		button.position.z = -4.25;
		train.add(button);
		
		var box = new THREE.Mesh(new THREE.BoxGeometry(18, 20, 20), new THREE.MeshLambertMaterial({map: THREE.ImageUtils.loadTexture( 'http://i.imgur.com/LVFA9YT.png' ), overdraw: true}));
		box.position.set(0, 10, -17);
		train.add(box);
		
		var top = new THREE.Mesh(new THREE.CylinderGeometry(40, 40, 25, 32, 1, true, 2*Math.PI/5, Math.PI/5), new THREE.MeshLambertMaterial({map: THREE.ImageUtils.loadTexture( 'http://i.imgur.com/LVFA9YT.png' ), overdraw: true, side:THREE.DoubleSide}));
		top.rotation.set(0, Math.PI/2, Math.PI/2);
		top.position.set(0, -18, -18);
		train.add(top);
		
		var tire = new THREE.Mesh(new THREE.CylinderGeometry(4, 4, 3, 32), new THREE.MeshLambertMaterial({map: THREE.ImageUtils.loadTexture( 'http://i.imgur.com/LVFA9YT.png' ), overdraw: true}));
		tire.rotation.z = Math.PI/2;
		tire.position.set(7, 0, -3);
		train.add(tire);
		var tire2 = tire.clone();
		tire2.position.set(-7, 0, -3);
		train.add(tire2);
		var tire3 = tire.clone();
		tire3.position.set(-7, 0, 5);
		train.add(tire3);
		var tire4 = tire.clone();
		tire4.position.set(7, 0, 5);
		train.add(tire4);
		
		var tire5 = new THREE.Mesh(new THREE.CylinderGeometry(2, 2, 3, 32), new THREE.MeshLambertMaterial({map: THREE.ImageUtils.loadTexture( 'http://i.imgur.com/LVFA9YT.png' ), overdraw: true}));
		tire5.rotation.z = Math.PI/2;
		tire5.position.set(7, -2, 12);
		train.add(tire5);
		var tire6 = tire5.clone();
		tire6.position.set(-7, -2, 12);
		train.add(tire6);
		var tire7 = tire5.clone();
		tire7.position.set(-7, -2, -18);
		train.add(tire7);
		var tire8 = tire5.clone();
		tire8.position.set(7, -2, -18);
		train.add(tire8);
		
		var material = new THREE.MeshLambertMaterial( { map: THREE.ImageUtils.loadTexture( 'http://i.imgur.com/LVFA9YT.png' ), overdraw: true } )
		var geometry = new THREE.CylinderGeometry( 5, 5, 5, 32, 1, false);
		
		
		var tube = new THREE.Mesh(geometry, material);
		tube.position.set(0, 15, 0);
		train.add(tube);
		var tube2 = new THREE.Mesh(new THREE.CylinderGeometry(2, 2, 10, 32), new THREE.MeshLambertMaterial({map: THREE.ImageUtils.loadTexture( 'http://i.imgur.com/LVFA9YT.png' ), overdraw: true }));
		tube2.position.set(0, 15, 12);
		train.add(tube2);
		var tube3 = new THREE.Mesh(new THREE.CylinderGeometry(4, 2, 5, 32), new THREE.MeshLambertMaterial({map: THREE.ImageUtils.loadTexture( 'http://i.imgur.com/LVFA9YT.png' ), overdraw: true }));
		tube3.position.set(0, 18, 12);
		train.add(tube3);
		
		scene.add (train);
	}

	function trackmake(){
		var round = new THREE.Mesh(new THREE.TorusGeometry(74, 1, 2, 64), new THREE.MeshLambertMaterial({color:0x123456}));
	  track.add(round);
	  var round2 = new THREE.Mesh(new THREE.TorusGeometry(86, 1, 2, 64), new THREE.MeshLambertMaterial({color:0x123456}));
	  track.add(round2);
	  
	  track.rotation.x = Math.PI/2;
	  scene.add(track);
	  
	  
	  
	}

	function onWindowResize() {
	  camera.aspect = window.innerWidth / window.innerHeight;
	  camera.updateProjectionMatrix();
	  renderer.setSize(window.innerWidth, window.innerHeight);
	}

	function animate() {
		controls.update();
	  
	  var dt = clock.getDelta();
	  train.position.set(80*Math.cos(angle), 5, 80*Math.sin(angle));
	  train.rotation.y = -angle;
	  angle += dt;
	  
	  requestAnimationFrame(animate);
	  renderer.render(scene, camera);
	  
	}


</script>
</body>

</html>

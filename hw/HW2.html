<!DOCTYPE html>

<html>

<head>
<style>
#info {
  position: absolute;
  top: 2%;
  width: 100%;
  padding: 10px;
  text-align: center;
  color: #ffff00
}
#gui {
    position: absolute;
    top: 40px;
    left: 20px;
    height: 300px;
}
body {
  overflow: hidden;
}
.folder .dg ul {
  margin-top: 0 !important;
}


</style>
</head>

<body> 
<div id="info">Opening Box
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r74/three.min.js"></script>
<script src="https://dl.dropboxusercontent.com/u/3587259/Code/Threejs/OrbitControls.js">
<script src="https://code.jquery.com/jquery-2.1.4.min.js">
</script>
<script src="//cdnjs.cloudflare.com/ajax/libs/dat-gui/0.5/dat.gui.min.js"></script>

<script>
var camera, scene, renderer;
var head = new THREE.Object3D();
var body = new THREE.Object3D();
var lid = new THREE.Object3D();
var lid2 = new THREE.Object3D();
var leg = new THREE.Object3D();
var hand = new THREE.Object3D();
var all = new THREE.Object3D();
var H, B;

var art = new THREE.Object3D();
var mvhan = new THREE.Object3D();
var mvhanl = new THREE.Object3D();
var mvhad = new THREE.Object3D();
var mvleg = new THREE.Object3D();
var mvlegl = new THREE.Object3D();

var gui = new dat.GUI({load: loadJSON(), preset:  'Default'});

var a0 = {
	hx:0,
  hy:0, 
  hz:0, 
  bx:0, 
  bz:0, 
  hrx:0, 
  hrz:0, 
  hlx:0, 
  hlz:0, 
  lrx:0, 
  lrz:0, 
  llx:0, 
  llz:0,
  alls:0,
  allh:5,
  allb:0,
  ax:0,
  ay:0, 
  az:0
 };

init();
animate();

function init() {
  scene = new THREE.Scene();

  camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 1, 1000);
  camera.position.z = 200;
  scene.add(camera);

  var gridXZ = new THREE.GridHelper(50, 10);
  gridXZ.setColors(new THREE.Color(0xff00ff), new THREE.Color(0xffffff));
  scene.add(gridXZ);

  renderer = new THREE.WebGLRenderer();
  renderer.setSize(window.innerWidth, window.innerHeight);
  renderer.setClearColor(0x888888);

  controls = new THREE.OrbitControls(camera, renderer.domElement);
  var light = new THREE.PointLight(0xffffff, 1);
  light.position.set(150, 150, 150);
  scene.add(light);
  var amblight = new THREE.AmbientLight(0x404040); // soft white light
  scene.add(amblight);
  document.body.appendChild(renderer.domElement);
  window.addEventListener('resize', onWindowResize, false);
  ///////////////////////////////////////////////////////////////
  //head
  
  H = headmake();
  H.position.set(0, 29, 0);
  scene.add(H);
  H.rotation.set(a0.hx, a0.hy, a0.hz, 'ZYX');
  all.add(H);
  
  //body
  
  B = bodymake();
  B.position.set(0, 14.5, 0);
  var lidf = lidmake();
  lidf.position.set(0, -9.2, 7.2);
  lidf.rotation.set(-Math.PI/4, 0, 0, 'ZYX');
  B.add(lidf);
  var lidb = lidmake();
  lidb.position.set(0, -9.2, -7.2);
  lidb.rotation.set(Math.PI/4, 0, 0, 'ZYX');
  B.add(lidb);
  var lidl = lid2make();
  lidl.position.set(6.7, -9.8, 0);
  lidl.rotation.set(-Math.PI/10, Math.PI/2, 0, 'ZYX');
  B.add(lidl);
  var lidr = lid2make();
  lidr.position.set(-6.7, -9.8, 0);
  lidr.rotation.set(-Math.PI/10, -Math.PI/2, 0, 'ZYX');
  B.add(lidr);
  all.add(B);
  
//leg
  
  movleR = movethings();
  movleR.rotation.set = (0, 0, Math.PI/2, 'ZYX');
  mvleg.add(movleR);
  var LRG = legmake();
  LRG.position.y = -5;
  mvleg.add(LRG);
  mvleg.position.set(2.8, 4.5, 0);
  mvleg.rotation.set(0, 0, 0, 'ZYX');
  all.add(mvleg);
  
  movleL = movethings();
  movleL.rotation.set = (0, 0, Math.PI/2, 'ZYX');
  mvlegl.add(movleL);
  var LLG = legmake();
  LLG.position.y = -5;
  mvlegl.add(LLG);
  mvlegl.position.set(-2.8, 4.5, 0);
  mvlegl.rotation.set(0, 0, 0, 'ZYX');
  all.add(mvlegl);

//hand

	movhanR = movethings();
  movhanR.rotation.set = (Math.PI/2, 0, 0, 'ZYX');
  mvhan.add(movhanR);
  var HDR = handmake();
  HDR.position.y = -7;
  mvhan.add(HDR);
  mvhan.position.set(7.9, 20, 0);
  mvhan.rotation.set(a0.hrx, 0, 0, 'ZYX');
  mvhan.rotation.x = a0.hrx;
  all.add(mvhan);
  
 	movhanL = movethings();
  movhanL.rotation.set = (Math.PI/2, 0, 0, 'ZYX');
  mvhanl.add(movhanL);
  var HDL = handmake();
  HDL.position.y = -7;
  mvhanl.add(HDL);
  mvhanl.position.set(-7.9, 20, 0);
  mvhanl.rotation.set(0, 0, 0, 'ZYX');
  all.add(mvhanl);
  
  //all
  
  all.position.y = 5;
  scene.add(all);
  
  //gui
  gui.remember(a0);
  gui.domElement.id = 'gui';
  var HH = gui.addFolder('Head');
  HH.add(a0, 'hx', -0.2, 0.2);
  HH.add(a0, 'hy', -1, 1);
  HH.add(a0, 'hz', -0.2, 0.2);
  var DD = gui.addFolder('Hand');
  DD.add(a0, 'hrx', -1.2, 1.2);
  DD.add(a0, 'hrz', 0, 1.2);
  DD.add(a0, 'hlx', -1.2, 1.2);
  DD.add(a0, 'hlz', -1.2, 0);
  var BB = gui.addFolder('Body');
  BB.add(a0, 'bx', -0.2, 0.5);
  BB.add(a0, 'bz', -0.2, 0.2);
  var LL = gui.addFolder('Leg');
  LL.add(a0, 'lrx', -1.2, 1.2);
  LL.add(a0, 'lrz', 0, 1.2);
  LL.add(a0, 'llx', -1.2, 1.2);
  LL.add(a0, 'llz', -1.2, 0);
  var A = gui.addFolder('High');
  A.add(a0, 'alls', -30, 30);
  A.add(a0, 'allh', -15, 50);
  A.add(a0, 'allb', -30, 30);
  A.add(a0, 'ax', -Math.PI, Math.PI);
  A.add(a0, 'ay', -Math.PI, Math.PI);
  A.add(a0, 'az', -Math.PI, Math.PI);
  gui.close();
  
}

function movethings(){
	art = new THREE.Mesh(new THREE.DodecahedronGeometry(2, 1), new THREE.MeshLambertMaterial({color: 0xffffff, wireframe: true}));
  
  return art;
}

function headmake(){
	var box = [];
  
  THREE.ImageUtils.crossOrigin = '';
  box.push(new THREE.MeshLambertMaterial({
  	side:THREE.DoubleSide,
 map:THREE.ImageUtils.loadTexture('http://i.imgur.com/PG3l9pY.png')
  }));
  box.push(new THREE.MeshLambertMaterial({
  	side:THREE.DoubleSide,
 map:THREE.ImageUtils.loadTexture('http://i.imgur.com/7U5kOvO.png')
    }));
  box.push(new THREE.MeshLambertMaterial({
  	side:THREE.DoubleSide,
 map:THREE.ImageUtils.loadTexture('http://i.imgur.com/JmFDoW8.png')
    }));
  box.push(new THREE.MeshLambertMaterial({visible:false}));
  box.push(new THREE.MeshLambertMaterial({
  	side:THREE.DoubleSide,
 map:THREE.ImageUtils.loadTexture('http://i.imgur.com/0r7R8eV.png')
    }));
  box.push(new THREE.MeshLambertMaterial({
  	side:THREE.DoubleSide,
 map:THREE.ImageUtils.loadTexture('http://i.imgur.com/q2rISky.png')
    }));
  
  head = new THREE.Mesh(new THREE.BoxGeometry(25, 16, 17.5), new THREE.MeshFaceMaterial(box));
  
  return head;
}

function bodymake(){
	var box = [];
  
  box.push(new THREE.MeshLambertMaterial({
  	side:THREE.DoubleSide, 
    color: 0xa78c6b
    }));
  box.push(new THREE.MeshLambertMaterial({
  	side:THREE.DoubleSide, 
    color: 0xa78c6b
    }));
  box.push(new THREE.MeshLambertMaterial({
  	side:THREE.DoubleSide, 
    color: 0xa78c6b
    }));
  box.push(new THREE.MeshLambertMaterial({visible:false}));
  box.push(new THREE.MeshLambertMaterial({
  	side:THREE.DoubleSide,
    map: THREE.ImageUtils.loadTexture('http://i.imgur.com/AF7k357.png'
  )}));
  box.push(new THREE.MeshLambertMaterial({
  	side:THREE.DoubleSide,
    map: THREE.ImageUtils.loadTexture('http://i.imgur.com/AF7k357.png'
  )}));
  
  body = new THREE.Mesh(new THREE.BoxGeometry(12, 15, 11.5), new THREE.MeshFaceMaterial(box));
  
  return body;
}

function lidmake(){
	lid = new THREE.Mesh(new THREE.PlaneGeometry(12, 5, 2.5), new THREE.MeshLambertMaterial({side:THREE.DoubleSide, color: 0xa88d6c}));
  
  return lid;
}

function lid2make(){
	lid2 = new THREE.Mesh(new THREE.PlaneGeometry(11.5, 5, 2.5), new THREE.MeshLambertMaterial({side:THREE.DoubleSide, color: 0xa88d6c}));
  
  return lid2;
}

function legmake(){
	leg = new THREE.Mesh(new THREE.BoxGeometry(5, 10, 11), new THREE.MeshLambertMaterial({side:THREE.DoubleSide, color: 0xa88d6c}));
  
  return leg;
}

function handmake(){
	hand = new THREE.Mesh(new THREE.BoxGeometry(5, 12, 5), new THREE.MeshLambertMaterial({side:THREE.DoubleSide, color: 0xa88d6c}));
  
  return hand;
}

function loadJSON(){
	return{
  "preset": "pose3",
  "remembered": {
    "Default": {
      "0": {
        "hx": 0,
        "hy": 0,
        "hz": 0,
        "hrx": 0,
        "hrz": 0,
        "hlx": 0,
        "hlz": 0,
        "bx": 0,
        "bz": 0,
        "lrx": 0,
        "lrz": 0,
        "llx": 0,
        "llz": 0,
        "alls": 0,
        "allh": 5,
        "allb": 0,
        "ax": 0,
        "ay": 0,
        "az": 0
      }
    },
    "pose1": {
      "0": {
        "hx": 0.016163993475376615,
        "hy": 0.34551057163244625,
        "hz": 0.13968627546130613,
        "hrx": -1.2,
        "hrz": 0.5955538595750172,
        "hlx": 1.2,
        "hlz": -0.6044461404249828,
        "bx": 0.29408912794371794,
        "bz": -0.058831677730366294,
        "lrx": 1.2,
        "lrz": 0,
        "llx": -1.2,
        "llz": -0.06183040170107823,
        "alls": 0,
        "allh": 5,
        "allb": 0,
        "ax": 0,
        "ay": 0,
        "az": 0
      }
    },
    "pose2": {
      "0": {
        "hx": 0.2,
        "hy": -0.12050739957716705,
        "hz": -0.15489781536293165,
        "hrx": 0.504862579281184,
        "hrz": 0.3517970401691332,
        "hlx": -1.2,
        "hlz": -0.7805496828752643,
        "bx": 0.1788583509513742,
        "bz": 0.2,
        "lrx": -0.08829946212663464,
        "lrz": 0.50291214808557,
        "llx": -0.16770664340330343,
        "llz": -0.33975553616941945,
        "alls": 0,
        "allh": 5,
        "allb": 0,
        "ax": 0,
        "ay": 0,
        "az": 0
      }
    },
    "pose3": {
      "0": {
        "hx": 0.002929463262598464,
        "hy": 0.05876241702225293,
        "hz": -0.010305066950179687,
        "hrx": -0.2528541226215645,
        "hrz": 0.21649048625792813,
        "hlx": -0.40592818723331037,
        "hlz": -0.27358288510552875,
        "bx": 0.21688770170251198,
        "bz": 0.011752483404450592,
        "lrx": 0.36167456510782303,
        "lrz": 0,
        "llx": -1.2,
        "llz": -0.4985698987227575,
        "alls": 0,
        "allh": 5,
        "allb": 0,
        "ax": 0,
        "ay": 0,
        "az": 0
      }
    }
  },
  "closed": false,
  "folders": {
    "Head": {
      "preset": "Default",
      "closed": true,
      "folders": {}
    },
    "Hand": {
      "preset": "Default",
      "closed": true,
      "folders": {}
    },
    "Body": {
      "preset": "Default",
      "closed": true,
      "folders": {}
    },
    "Leg": {
      "preset": "Default",
      "closed": true,
      "folders": {}
    },
    "High": {
      "preset": "Default",
      "closed": false,
      "folders": {}
    }
  }
}
}

function onWindowResize() {
  camera.aspect = window.innerWidth / window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
}

function animate() {
  controls.update();
  
  H.rotation.set(a0.hx, a0.hy, a0.hz);
  mvhan.rotation.set(a0.hrx, 0, a0.hrz);
  mvhanl.rotation.set(a0.hlx, 0, a0.hlz);
  B.rotation.set(a0.bx, 0, a0.bz);
  mvleg.rotation.set(a0.lrx, 0, a0.lrz);
  mvlegl.rotation.set(a0.llx, 0, a0.llz);
  all.position.set(a0.alls, a0.allh, a0.allb);
  all.rotation.set(a0.ax, a0.ay, a0.az);
  
  requestAnimationFrame(animate);
  renderer.render(scene, camera);
}


</script>
</body>

</html>